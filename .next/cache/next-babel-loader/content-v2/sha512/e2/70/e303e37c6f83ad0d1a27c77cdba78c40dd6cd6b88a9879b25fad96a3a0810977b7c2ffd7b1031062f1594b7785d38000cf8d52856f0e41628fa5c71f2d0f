{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _slicedToArray from \"/Users/raudipra/Documents/Projects/Portfolio/portfolio-cms-fe/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/Users/raudipra/Documents/Projects/Portfolio/portfolio-cms-fe/components/Forms/ImageUploader.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport ReactCrop from 'react-image-crop';\nimport 'react-image-crop/lib/ReactCrop.scss';\n\nfunction ImageUploader() {\n  _s();\n\n  var _React$useState = React.useState(\"\"),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      src = _React$useState2[0],\n      setSrc = _React$useState2[1];\n\n  var _React$useState3 = React.useState({\n    unit: \"%\",\n    width: 30,\n    aspect: 1 / 1\n  }),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      crop = _React$useState4[0],\n      setCrop = _React$useState4[1];\n\n  var _React$useState5 = React.useState(null),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      croppedImage = _React$useState6[0],\n      setCroppedImage = _React$useState6[1];\n\n  var _React$useState7 = React.useState(null),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      imageRef = _React$useState8[0],\n      setImageRef = _React$useState8[1];\n\n  var handleFile = function handleFile(e) {\n    var fileReader = new FileReader();\n\n    fileReader.onloadend = function () {\n      setSrc(fileReader.result);\n    };\n\n    fileReader.readAsDataURL(e.target.files[0]);\n  };\n\n  var handleSubmit = function handleSubmit(e) {\n    e.preventDefault();\n    var formData = new FormData();\n    formData.append('user[profile_pic]', croppedImage);\n    addPhotoToUser(user, formData);\n  };\n\n  var onImageLoaded = function onImageLoaded(image) {\n    setImageRef(image);\n  };\n\n  var onCropChange = function onCropChange(crop) {\n    setCrop(crop);\n  };\n\n  var onCropComplete = function onCropComplete(crop) {\n    if (imageRef && crop.width && crop.height) {\n      getCroppedImg(imageRef, crop);\n    }\n  };\n\n  var getCroppedImg = function getCroppedImg(image, crop) {\n    var canvas = document.createElement(\"canvas\");\n    var scaleX = image.naturalWidth / image.width;\n    var scaleY = image.naturalHeight / image.height;\n    canvas.width = crop.width;\n    canvas.height = crop.height;\n    var ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(image, crop.x * scaleX, crop.y * scaleY, crop.width * scaleX, crop.height * scaleY, 0, 0, crop.width, crop.height);\n    var reader = new FileReader();\n    canvas.toBlob(function (blob) {\n      reader.readAsDataURL(blob);\n\n      reader.onloadend = function () {\n        dataURLtoFile(reader.result, 'cropped.jpg');\n      };\n    });\n  };\n\n  var dataURLtoFile = function dataURLtoFile(dataurl, filename) {\n    var arr = dataurl.split(','),\n        mime = arr[0].match(/:(.*?);/)[1],\n        bstr = atob(arr[1]),\n        n = bstr.length,\n        u8arr = new Uint8Array(n);\n\n    while (n--) {\n      u8arr[n] = bstr.charCodeAt(n);\n    }\n\n    var croppedImageTemp = new File([u8arr], filename, {\n      type: mime\n    });\n    setCroppedImage(croppedImageTemp);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Form, {\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"label\", {\n      htmlFor: \"profile_pic\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      id: \"profile_pic\",\n      value: profile_pic,\n      onChange: handleFile\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }, this), src && /*#__PURE__*/_jsxDEV(ReactCrop, {\n      src: src,\n      crop: crop,\n      onImageLoaded: onImageLoaded,\n      onComplete: onCropComplete,\n      onChange: onCropChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      children: \"save\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 9\n  }, this);\n}\n\n_s(ImageUploader, \"SQJUVwxoHPISWsQf93Rg7z6RdLU=\");\n\n_c = ImageUploader;\nexport default ImageUploader;\n\nvar _c;\n\n$RefreshReg$(_c, \"ImageUploader\");","map":{"version":3,"sources":["/Users/raudipra/Documents/Projects/Portfolio/portfolio-cms-fe/components/Forms/ImageUploader.js"],"names":["React","ReactCrop","ImageUploader","useState","src","setSrc","unit","width","aspect","crop","setCrop","croppedImage","setCroppedImage","imageRef","setImageRef","handleFile","e","fileReader","FileReader","onloadend","result","readAsDataURL","target","files","handleSubmit","preventDefault","formData","FormData","append","addPhotoToUser","user","onImageLoaded","image","onCropChange","onCropComplete","height","getCroppedImg","canvas","document","createElement","scaleX","naturalWidth","scaleY","naturalHeight","ctx","getContext","drawImage","x","y","reader","toBlob","blob","dataURLtoFile","dataurl","filename","arr","split","mime","match","bstr","atob","n","length","u8arr","Uint8Array","charCodeAt","croppedImageTemp","File","type","profile_pic"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport ReactCrop from 'react-image-crop'\nimport 'react-image-crop/lib/ReactCrop.scss'\n\nfunction ImageUploader() {\n    const [src, setSrc] = React.useState(\"\");\n    const [crop, setCrop] = React.useState({\n        unit: \"%\",\n        width: 30,\n        aspect: 1 / 1\n    });\n    const [croppedImage, setCroppedImage] = React.useState(null);\n    const [imageRef, setImageRef] = React.useState(null);\n    \n    const handleFile = e => {\n        const fileReader = new FileReader()\n        fileReader.onloadend = () => {\n            setSrc(fileReader.result)\n        }   \n        fileReader.readAsDataURL(e.target.files[0])\n    }\n\n    const handleSubmit = e => {\n        e.preventDefault()\n        const formData = new FormData()\n            \n        formData.append('user[profile_pic]', croppedImage)\n\n        addPhotoToUser(user, formData)\n    }\n\n    const onImageLoaded = image => {\n        setImageRef(image)\n    }\n\n    const onCropChange = (crop) => {\n        setCrop(crop);\n    }\n\n    const onCropComplete = crop => {\n        if (imageRef && crop.width && crop.height) {\n            getCroppedImg(imageRef, crop)\n        }\n    }\n\n    const getCroppedImg = (image, crop) => {\n        const canvas = document.createElement(\"canvas\");\n        const scaleX = image.naturalWidth / image.width;\n        const scaleY = image.naturalHeight / image.height;\n        canvas.width = crop.width;\n        canvas.height = crop.height;\n        const ctx = canvas.getContext(\"2d\");\n        \n        ctx.drawImage(\n            image,\n            crop.x * scaleX,\n            crop.y * scaleY,\n            crop.width * scaleX,\n            crop.height * scaleY,\n            0,\n            0,\n            crop.width,\n            crop.height\n        )\n\n        const reader = new FileReader()\n        canvas.toBlob(blob => {\n            reader.readAsDataURL(blob)\n            reader.onloadend = () => {\n                dataURLtoFile(reader.result, 'cropped.jpg')\n            }\n        })\n    }\n\n    const dataURLtoFile = (dataurl, filename) => {\n        let arr = dataurl.split(','),\n            mime = arr[0].match(/:(.*?);/)[1],\n            bstr = atob(arr[1]), \n            n = bstr.length, \n            u8arr = new Uint8Array(n);\n                \n        while(n--){\n            u8arr[n] = bstr.charCodeAt(n);\n        }\n        let croppedImageTemp = new File([u8arr], filename, {type:mime});\n        setCroppedImage(croppedImageTemp) \n    }\n\n    return (\n        <Form onSubmit={handleSubmit}>\n            <label htmlFor=\"profile_pic\"></label>\n            <input type='file' id='profile_pic' value={profile_pic} \n            onChange={handleFile} />\n            {src && (\n                <ReactCrop\n                src={src}\n                crop={crop}\n                onImageLoaded={onImageLoaded}\n                onComplete={onCropComplete}\n                onChange={onCropChange}\n                /> \n            )}\n            <button>save</button>\n        </Form>\n    );\n}\n\nexport default ImageUploader;"]},"metadata":{},"sourceType":"module"}